     /*       16:23:00 Nov 3, 2014        21:34:26 Jan 26, 2017.                    */  var isMenuOpen = false; var eventtype = mobilecheck() ? 'touchstart' : 'click';  jQuery(function($) {      /****************     **  MENU/HEADER     *****************/      if( !mobilecheck() ) {         $('.open-menu').on('mouseover', function(e){ openIconMenu(); });         $('.open-menu').on('mouseout', function(e){ closeIconMenu(); });               $('.menu-wrapper').on( 'mouseover' , function(e){              openMenu(e);              addDocumentClickBind();         });     }     $('.open-menu').on(eventtype, function(e) {          e.stopPropagation();         e.preventDefault();          if( isMenuOpen ) {             closeMenu();             $(document).unbind( eventtype );         }else {             openMenu();             addDocumentClickBind();         }     });     $('.menu-wrapper').bind( eventtype, function(e) { e.stopPropagation(); } );        /****************     **  HEADER SWIPER     *****************/     if($('.swiper-container-top-header').length > 0){         slidesPerView = 1;          // Init Instagram widget         var top_swiper = new Swiper('.swiper-container-top-header', {           loop: true,           pagination: '.swiper-top-header-pagination',           paginationClickable: true,           slidesPerView: slidesPerView,           onTouchEnd : function(element) { $('.swiper-container').removeClass('active'); },           onTouchStart : function(element) { $('.swiper-container').addClass('active'); },           onSlideChangeEnd : function(element) { $('.swiper-container').removeClass('active'); },           calculateHeight: true,         });          top_swiper.reInit();          $('.swiper-top-header-pagination span').each(function(e){             $(this).after('<div>'+$('.swiper-container-top-header .swiper-wrapper .swiper-slide').eq(e).attr('data-posttitle')+'</div>');             // console.log($('.swiper-container-top-header .swiper-wrapper .swiper-slide').eq($(this).index()).attr('data-posttitle'));         });     }     // Shrink header on scroll down     if(!blu.disable_fixed_header){ /*        var y;         y = $(window).scrollTop();                      if($(window).width() > 979){             masthead_height = $('#masthead').height();              if($('body').hasClass('admin-bar')){                  masthead_top = ($('#masthead').offset().top-28);              }             else{                  masthead_top = $('#masthead').offset().top;              }             if(y > masthead_top){                  $('.masthead-container').addClass('fixed');                  // $('#main').css('padding-top', (masthead_height+25)+'px');              }             if(y > 300){  $('.masthead-container').addClass('shrink'); }                  else{ $('.masthead-container').removeClass('shrink'); }             // Shrink menu on scroll             var didScroll = false;             $(window).scroll(function() {                 didScroll = true;             });             setInterval(function() {                 if ( didScroll ) {                     didScroll = false;                     y = $(window).scrollTop();                     if(y > 300){  $('.masthead-container').addClass('shrink'); }                     else{ $('.masthead-container').removeClass('shrink'); }                 }             }, 70);                      }*/     }else{         $('#page').addClass('static-header');      }      /****************     **  OPEN POST META TOP     *****************/ /*    if($('.post-meta-open').length > 0){         $('.post-meta-open').click(function(e){             $(this).next('.post-meta').toggleClass('open');         });     }*/      /****************     **  MINIMIZE WIDGET HEADER     *****************/     if($('.widget-head .min').length > 0){         $('.widget-head .min').click(function(e){             e.preventDefault();             $(this).parent().nextAll().toggle('fast');         });     }      /****************     **  SOCIAL POSTS LOAD     *****************/     var didScroll2 = true,         normalLayout = false;     // if the layout isn't twocolumn or three column then load the posts that are already in view immediately     if(!$('#content').hasClass('twocolumn') && !$('#content').hasClass('threecolumn') && !$('#content').hasClass('fourcolumn') && !$('#content').hasClass('fivecolumn')){         normalLayout = true;     }     $(window).scroll(function() {         didScroll2 = true;     });     setInterval(function() {         if ( didScroll2 ) {             didScroll2 = false;             y2 = $(window).scrollTop();              if($('.facebook-store').length > 0){                 $('.facebook-store').each(function(e){                     if((y2 > $(this).offset().top - 800 && y2 < $(this).offset().top + 200) && !$(this).data('loaded') ) {                         $(this).data('loaded', '1');                         console.log('thewidth: ' + $(this).width());                         $(this).html($(this).data('code'));                         FB.XFBML.parse($(this).get(0));                         // if it's a column layout then remove the iframe and put in an icon with a link                         if(!normalLayout){                                // $(this).find('iframe').remove();                             $(this).html('<a class="facebook-fallback" href="'+$(this).find('.fb-post').data('href')+'"><i class="icon-facebook-1"></i></a>');                         }                     }                 });             }             if($('.twitter-store').length > 0){                 $('.twitter-store').each(function(e){                     if((y2 > $(this).offset().top - 800 && y2 < $(this).offset().top + 200) && !$(this).data('loaded') ) {                         $(this).data('loaded', '1');                         $(this).html($(this).data('code'));                         // if(twttr != 'undefined')                             // twttr.widgets.load();                     }                 });             }             if($('.google-store').length > 0){                 $('.google-store').each(function(e){                     if((y2 > $(this).offset().top - 800 && y2 < $(this).offset().top + 200) && !$(this).data('loaded') ) {                         $(this).data('loaded', '1');                         $(this).html($(this).data('code'));                         gapi.follow.go();                     }                 });             }         }     }, 600);       /****************     **  COMMENT SCORE     *****************/     // AJAX Comment Vote     $('.blu-comment-vote').unbind('click').click( function(e) {         e.stopPropagation();         e.preventDefault();         var previousScore = +$(this).parent().find('.total-score').html();         var commentID = $(this).data('commentid');         var voteType;         if($(this).hasClass('blu-comment-vote-up')){             previousScore++;             voteType = 'up';         }else{             previousScore--;             voteType = 'down';         }         $that = $(this);         $.ajax({               type: 'POST',               url: blu.ajaxurl,               data: {                   action: 'blu_ajax_comment_score',                 commentid: commentID,                 votetype: voteType,                 previousScore: previousScore             },               success: function(data, textStatus, XMLHttpRequest){                   if(!data){                       $that.css('color','#DDDDDD');                     $that.parent().find('.total-score').html(previousScore++).addClass('vote-'+voteType);                     console.log(previousScore - 1 );                     if(voteType = 'down' && ( previousScore - 1 < 0 )){                         $that.closest('li').addClass('mute');                     }                 }else{                     $that.parent().find('.total-score').after('<span class="already-voted">Already voted!</span>');                  }             },               error: function(MLHttpRequest, textStatus, errorThrown){                   $that.parent().find('.total-score').after('<span class="already-voted">Error: ' + errorThrown + '</span>');              }           });     });       // load google+ button if there's a button present     if($('.google-plus-button').length > 0){         (function() {             var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;             po.src = '/web/20141103162300/https://apis.google.com/js/platform.js';             var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);         })();     }     // load twitter button if there's a button present     if($('.twitter-button').length > 0){         !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');     }       /****************     **  SWIPER     *****************/     if($('.swiper-gallery').length > 0){         imagesLoaded( document.querySelector('#content'), function( instance ) {             // Gallery             $('.swiper-gallery').each(function(e){                 $swiper = $(this);                 $(this).swiper({                     pagination: '.swiper-pagination',                     loop:true,                     paginationClickable: true,                     slidesPerView: 1,                     preventLinks: false,                     releaseFormElements: true,                     keyboardControl: true,                     watchActiveIndex: true,                     noSwiping: true,                     onSlideChangeStart: function(){                         $('.swiper-gallery').height( $($swiper.swiper().activeSlide()).find('img').height() );                         console.log('swiped swiper');                     },                     onImagesReady: function(){                         // $swiper.css( 'opacity', '1' );                         $('.swiper-gallery').css( 'opacity', '1' );                                                  $('.swiper-gallery').height( $($swiper.swiper().activeSlide()).find('img').height() );                         console.log('loaded swiper');                     }                 })             });                               $('.swiper-gallery .arrow-left').on('click', function(e){                     e.preventDefault();                     $(this).closest('.swiper-gallery').swiper().swipePrev();                 });                 $('.swiper-gallery .arrow-right').on('click', function(e){                     e.preventDefault();                     $(this).closest('.swiper-gallery').swiper().swipeNext();                 });         });     }      /****************     **  ENTRY IMAGE OPEN DRAWER     *****************/     if($('.open-entry-image').length > 0){         $('.open-entry-image').click(function(e){             e.preventDefault();             $(this).siblings('.entry-image').toggleClass('open');         });     }      /****************     **  IMAGE COMMENTS     *****************/     // Add Image Comment functionality     if($('.image-comment').length > 0){         imagesLoaded( document.querySelector('.image-comment'), function( instance ) {             $('.image-comment-on .image-comment').each(function(){                 // insert lightbox button                 if(!$(this).hasClass('entry-head')){                     $(this).find('img').after('<a href="' + $(this).data('href') + '" class="image-open lightbox btn btn-default"><i class="fa fa-arrows-alt"></i></a>');                     $(this).find('.image-open').magnificPopup({type:'image'});                 }             });              $('.image-comment-on .image-comment .image-open').click( function(e) {                 e.stopPropagation();                 // e.preventDefault();             });             $('.image-comment-on .image-comment').click( function(e) {                 e.stopPropagation();                 e.preventDefault();                 cropClose();                 // comment container                 var information = "";                 if($('#author').length > 0){ information = "<input id='image-author' type='text' placeholder='Your Name'><input id='image-email' type='text' placeholder='Your Email'>"; }                 var container = '<div id="image-comment-crop-container" class="swiper-no-swiping"><div class="crop-center"><div class="crop-close">×</div></div><div class="submit-container swiper-no-swiping">' + information;                 if($(window).width() > 979){                     container +=  '<textarea rows="5" class="swiper-no-swiping"></textarea></a></div></div>';                 }                 $(this).remove('#image-comment-crop-container');                 if($('#image-comment-crop-container').length < 1){                     $(this).append(container);                 }                 $('#image-comment-crop-container #image-author').click(function(e){                     e.stopPropagation();                     e.preventDefault();                 });                 $('#image-comment-crop-container #image-author').change(function(e){                     $('#author').val($(this).val());                 });                 $('#image-comment-crop-container #image-email').click(function(e){                     e.stopPropagation();                     e.preventDefault();                 });                 $('#image-comment-crop-container #image-email').change(function(e){                     $('#email').val($(this).val());                 });                 $('#image-comment-crop-container textarea').click(function(e){                     e.stopPropagation();                     e.preventDefault();                 });                 $('#image-comment-crop-container textarea').change(function(e){                     $('#comment').val($(this).val());                 });                  // put in the correct information when clicked ( if there is any )                 if( $('#image-comment-crop-container #image-author').val() == '' ){                     $('#image-comment-crop-container #image-author').val($('#author').val());                 }                 if( $('#image-comment-crop-container #image-email').val() == ''  ){                     $('#image-comment-crop-container #image-email').val($('#email').val());                 }                 if( $('#image-comment-crop-container textarea').text() == ''  ){                     $('#image-comment-crop-container textarea').text($('#comment').val());                 }                  $('#image-comment-crop-container *:first-child').focus();                  $('#image-comment-crop-container .btn').click(function(e){                     e.stopPropagation();                     e.preventDefault();                     $('#comment').val($('#image-comment-crop-container textarea').val());                     $('#commentform #submit').trigger('click');                     $(this).unbind('click');                     $('#image-comment-crop-container textarea').unbind('click');                     $('#image-comment-crop-container textarea').unbind('change');                     $('#image-comment-crop-container #image-author').unbind('click');                     $('#image-comment-crop-container #image-author').unbind('change');                     $('#image-comment-crop-container #image-email').unbind('click');                     $('#image-comment-crop-container #image-email').unbind('change');                 });                  // close the crop tool and remove the selection                 $('.crop-close').click(function(e){                     e.preventDefault();                     cropClose();                     e.stopPropagation();                 });                  var posX_old = $(this).offset().left,                     posY_old = $(this).offset().top,                     posX = $(this).offset().left,                     posY = $(this).offset().top,                     image_width = $(this).children('img').attr('width'),                     image_container_height = $(this).height(),                     image_container_width = $(this).width(),                     image_ratio = (image_width/image_container_width),                     mobile_multiplication = 1,                     mobileY_fix = 0,                     mobileX_fix = 0,                     crop_tool_scale = 100,                     crop_tool_position_X = crop_tool_scale/2,                     crop_tool_position_Y = crop_tool_scale/2;                  $('#image-comment-crop-container .crop-center').css('height',crop_tool_scale);                 $('#image-comment-crop-container .crop-center').css('width',crop_tool_scale);                 $(this).find('.submit-container').css('width', (crop_tool_scale*3)+'px');                 $(this).find('.submit-container').css('margin-left', -(crop_tool_scale)+'px');                 container_positionY = (image_container_height - (e.pageY - posY_old));                 container_positionX = (image_container_width - (e.pageX - posX_old));                                  // WHERE TO DISPLAY THE CONTAINER:                   // if it's at the bottom                 if( container_positionY < (crop_tool_scale+100) || container_positionX < (crop_tool_scale+100)){                     $(this).find('.submit-container').css('top','-'+(crop_tool_scale+50)+'px');                     $(this).find('.submit-container').css('left', '-'+(crop_tool_scale+125)+'px');                 }                 // if it's all the way to the left                 if( container_positionX > image_container_width - (crop_tool_scale+100) || ( container_positionY < (crop_tool_scale+100) && container_positionX > image_container_width - 500 )){                     $(this).find('.submit-container').css('top','-'+(crop_tool_scale+50)+'px');                     $(this).find('.submit-container').css('left','auto');                     $(this).find('.submit-container').css('right', '-'+(crop_tool_scale+125)+'px');                 }                 // if the image has an alignright class then put it to the left                 if( $(this).hasClass('alignright') ){                     $(this).find('.submit-container').css('top','-'+(crop_tool_scale+50)+'px');                     $(this).find('.submit-container').css('left', '-'+(crop_tool_scale+125)+'px');                     $(this).find('.submit-container').css('right','auto');                 }                 // if it's a mobile view then stop the nonsense and just display it below!                 if( $(window).width() < 979 ){                     // add multiplier if it's mobile to enlargen the image                     mobile_multiplication = 2;                     mobileY_fix = -50;                     mobileX_fix = -50;                     $(this).find('.submit-container').css('display','none');                 }                  // fix the height if it's out of bounds ( bottom, top )                 if( (image_container_height - (e.pageY - posY)) < (crop_tool_scale)){                     posY = image_container_height - crop_tool_scale;                     crop_tool_position_Y = crop_tool_scale;                 }else if( (e.pageY - posY) < (crop_tool_scale/2) ){                     posY = 0;                 }else{                     posY = (e.pageY - posY) - (crop_tool_scale/2);                 }                  // fix the width if it's out of bounds ( right, left )                 if( (image_container_width - (e.pageX - posX)) < (crop_tool_scale)){                     posX = image_container_width - crop_tool_scale;                     crop_tool_position_X = crop_tool_scale;                 }else if( (e.pageX - posX) < (crop_tool_scale/2) ){                     posX = 0;                 }else{                     posX = (e.pageX - posX) - (crop_tool_scale/2);                 }                  // place the container at the appropriate coordinates                 $('#image-comment-crop-container').css('left', posX).css('top', posY);                  // get ready to set the coordinates into the html                 console.log('posY' + posY);                  posX = (posX * mobile_multiplication) - crop_tool_position_X - mobileY_fix;                 posY = (posY * mobile_multiplication) - crop_tool_position_Y - mobileY_fix;                 if(posY < 0){ posY = 0; }                 if(posX < 0){ posX = 0; }                 image_container_width = image_container_width * mobile_multiplication;                 image_container_height = image_container_height * mobile_multiplication;                  // put the image in the correct positions                 var img_src = $(this).children('img').attr('src');                  // display the placeholder                 $('#image-comment-placeholder').css('display', 'block');                  // position the image in the placeholder                 $('#image-comment-placeholder').html('').append('<div class="crop-close">×</div>').click(function(e){                     cropClose();                     e.stopPropagation();                 });                 $('#respond form').css('padding-left', '215px');                 $('#comment_image_location').val(posY+ ',' + posX + ',' + img_src + ',' + image_container_width);             });         });     }     // Image Crop Container Close     function cropClose(){         if($('#image-comment-crop-container').length > 0){             $('#image-comment-crop-container').remove();             $('#image-comment-placeholder').css('display','none');             $('#respond form').css('padding-left', '0');             $('#comment_image_location').val('false');         }     }      /****************     **  HELPERS     *****************/     $( '.share-post' ).click(function(e){ e.preventDefault(); });     if( $( '.timeago' ).length > 0 ){ $('.timeago').timeago(); }     if( $( '.tips' ).length > 0 ){ $('.tips').tooltip(); }     if( $( '.bl_popover' ).length > 0 ){ $('.bl_popover').popover(); }          /****************     **  LIGHTBOX     *****************/     if( $( '.lightbox' ).length > 0 ){       $('.lightbox' ).magnificPopup({type:'image'});        $( '.entry-content p .lightbox' ).each(function(){         $( this ).css('float', $( this ).children('img').css('float') );       });     }     // fade everything in on page load     $('.entry-content').animate({opacity:'1'}, 800, 'swing');     // Lightbox Gallery     suffixjpg = '.jpg';     suffixjpeg = '.jpeg';     suffixpng = '.png';     suffixgif = '.gif';     if( $( '.gallery' ).length > 0 ){       if( $( '.gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixjpg, $( '.gallery-item a' ).eq(0).length - suffixjpg.length) !== -1 || $( '.gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixjpeg, $( '.gallery-item a' ).eq(0).length - suffixjpeg.length) !== -1 || $( '.gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixpng, $( '.gallery-item a' ).eq(0).length - suffixpng.length) !== -1 || $( '.gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixgif, $( '.gallery-item a' ).eq(0).length - suffixgif.length) !== -1){         $( '.gallery' ).magnificPopup({             delegate: '.gallery-item a', // the container for each your gallery items             type: 'image',             gallery:{ enabled:true }         });       }     }     // Jetpack Lightbox Gallery     if( $( '.tiled-gallery').length > 0 ){       if( $( '.tiled-gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixjpg, $( '.tiled-gallery-item a' ).eq(0).length - suffixjpg.length) !== -1 || $( '.tiled-gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixjpeg, $( '.tiled-gallery-item a' ).eq(0).length - suffixjpeg.length) !== -1 || $( '.tiled-gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixpng, $( '.tiled-gallery-item a' ).eq(0).length - suffixpng.length) !== -1 || $( '.tiled-gallery-item a' ).eq(0).attr( 'href' ).indexOf(suffixgif, $( '.tiled-gallery-item a' ).eq(0).length - suffixgif.length) !== -1){         $( '.tiled-gallery' ).magnificPopup({             delegate: '.tiled-gallery-item a', // the container for each your gallery items             type: 'image',             gallery:{ enabled:true }         });       }     }          /****************     **  SYNTAX HIGHLIGHTING     *****************/     if( $("pre").length > 0 ){         $("pre.html").snippet("html",{style:"emacs"});         $("pre.css").snippet("css",{style:"emacs"});         $("pre.php").snippet("php",{style:"emacs"});         $("pre.js").snippet("javascript",{style:"emacs"});     }      /****************     **  Post Title fixes     *****************/     $('.format-quote .quote-area').each(function(e){         var width = $(this).width();         var height = $(this).height();         var image_height = $(this).next('img').height();         var font_change = 0;         var final_width = width;         // if the height of the text is larger than the height of the image, then shrink the final font size         if(height > image_height-80){              final_width = final_width - (height - image_height + 50);         }         if(final_width < 200){ final_width = 200; }         if(final_width > 1000){ final_width = 1000; }          $(this).find('.quote-text').css('font-size', (final_width/14)+'px');         height = $(this).height();         $(this).height(height);                  $(this).css('margin-top', '-'+(height/2)+'px');         $(this).css('opacity', '1');     });     $('.author-posts-item').each(function(e){         var width = $(this).width();         $(this).height($(this).width());         $(this).find('h3').css('font-size', (width/10)+'px');         var height = $(this).height();                  $(this).find('a').height(height);         $(this).find('h3').css('margin-top', '-'+($(this).find('h3').height()/2)+'px');         // $(this).css('opacity', '1');     });      /****************     **  Instagram Widget     *****************/     if($('.blu_instagram').length > 0){         slidesPerView = 1;          // Init Instagram widget         var instagram_swiper = new Swiper('.swiper-container-instagram', {           loop: true,           paginationClickable: true,           slidesPerView: slidesPerView,           onTouchEnd : function(element) { $('.swiper-container').removeClass('active'); },           onTouchStart : function(element) { $('.swiper-container').addClass('active'); },           onSlideChangeEnd : function(element) { $('.swiper-container').removeClass('active'); },                  calculateHeight: true,         });          // enable pagination arrows         $('.swiper-container-instagram .arrow-left').on('click', function(e){           e.preventDefault();           instagram_swiper.swipePrev();         });         $('.swiper-container-instagram .arrow-right').on('click', function(e){           e.preventDefault();           instagram_swiper.swipeNext();         });          instagram_swiper.reInit();     }     /****************     **  Flickr Widget     *****************/     if($('.blu_flickr').length > 0){         slidesPerView = 1;          // Init Instagram widget         var flickr_swiper = new Swiper('.swiper-container-flickr', {           loop: true,           paginationClickable: true,           slidesPerView: slidesPerView,           onTouchEnd : function(element) { $('.swiper-container').removeClass('active'); },           onTouchStart : function(element) { $('.swiper-container').addClass('active'); },           onSlideChangeEnd : function(element) { $('.swiper-container').removeClass('active'); },                  calculateHeight: true,         });          // enable pagination arrows         $('.swiper-container-flickr .arrow-left').on('click', function(e){           e.preventDefault();           flickr_swiper.swipePrev();         });         $('.swiper-container-flickr .arrow-right').on('click', function(e){           e.preventDefault();           flickr_swiper.swipeNext();         });          flickr_swiper.reInit();     }         /****************     **  Featured Posts Widget     *****************/     if($('.bl_featured_post').length > 0){         slidesPerView = 1;          // Init Instagram widget         var featured_swiper = new Swiper('.swiper-container-featured', {           loop: true,           paginationClickable: true,           slidesPerView: slidesPerView,           onTouchEnd : function(element) { $('.swiper-container').removeClass('active'); },           onTouchStart : function(element) { $('.swiper-container').addClass('active'); },           onSlideChangeEnd : function(element) { $('.swiper-container').removeClass('active'); },                  calculateHeight: true,         });          // enable pagination arrows         $('.swiper-container-featured .arrow-left').on('click', function(e){           e.preventDefault();           featured_swiper.swipePrev();         });         $('.swiper-container-featured .arrow-right').on('click', function(e){           e.preventDefault();           featured_swiper.swipeNext();         });          $('.swiper-container-featured .swiper-slide a').each(function(e){             var width = $(this).find('.post-title').width();             $(this).find('.post-title').css('font-size', (width/12)+'px');             var height = $(this).height();             console.log(height);             $(this).height(height);             $(this).find('.post-title').css('margin-top', '-'+($(this).find('.post-title').height()/2)+'px');             $(this).find('.post-title').css('opacity', '1');         });          featured_swiper.reInit();     }     /****************     **  Next Page Animation     *****************/ /*    $('.single-pagination.animate').click(function(e){         e.preventDefault();         $that = $(this);         topOffset = $('#content').offset().top;         $('article').addClass('box');         $('.entry-content').animate({opacity:'0'}, 400, 'swing');         if($('.entry-image').length > 0){             $('.entry-image').animate({opacity:'0'}, 400);         }         if($('.entry-video').length > 0){             $('.entry-video iframe').remove();             $('.entry-video').animate({opacity:'0'}, 0);         }         $('#side-bar').animate({opacity:'0'}, 500, 'swing');         $('html, body').animate({scrollTop:'0'}, 400, 'swing');         $(this).animate({top:'-'+($(this).offset().top-topOffset)+'px'}, 400, 'swing', function(){             $that.find('h3').animate({opacity:'0'}, 400);             window.location = $that.attr('href');         });         // console.log($(this).offset().top);     })     if($('article.fromnext .entry-image').length > 0){         $('article.fromnext .entry-image').animate({height:$('article.fromnext .entry-image img').height()}, 400, 'swing');     }*/            /****************     **  MASONRY     *****************/     if($('#content').hasClass('twocolumn') || $('#content').hasClass('threecolumn') || $('#content').hasClass('fourcolumn') || $('#content').hasClass('fivecolumn')){          var $container = $('#content .columns');         // initialize         $container.masonry({             itemSelector: 'article'         });          var didTimeOut = false;         $('#content .columns article .entry-image').resize(function(e){             $('#content .columns').masonry();         });     }      /****************     **  FIX VIDEO SIZES     *****************/     if( $(".entry-video iframe").length > 0){         var $container  = $("#content article .entry-video");         console.log($container.width());         var added_padding = 0;          var $video  = $(".entry-video iframe"),             did_resize  = false;          var width = 16;         var height = 9;          $video.attr('data-aspectRatio', height / width).removeAttr('height').removeAttr('width');          $(window).resize(function() {             did_resize = true;         }).resize();                   setInterval(function() {             if(did_resize){                 did_resize = false;                  var newWidth = $container.width() + added_padding;                 $video.width(newWidth).height(newWidth * $video.attr('data-aspectRatio'));             }         }, 300);     }       /****************     **  STICKY SIDEBAR     *****************/     // don't activate the sticky sidebar if the page is smaller then the sidebar area!     if($('#side-bar').innerHeight() < $('#content').innerHeight()){         if($(window).width() > 979){             // if there's an iframe then wait for the iframes to load             if( $('#side-bar iframe').length > 0 ){                 $('#side-bar iframe').load(function(){                     // just load it after 2 seconds, it's a crappy fix but it works most of the time                     setTimeout(function() {                         loadStickySidebar();                     }, 2000);                 });             }else{                 loadStickySidebar();             }         }     }  });  function loadStickySidebar(){     // if the sticky header is active then add 100 to the offset to make it look good     if(!blu.disable_fixed_header){         offsetAdd = 105;     }else{         offsetAdd = 40;     }     // wait for all the images to load     if(jQuery('.sticky_sidebar').length > 0){         imagesLoaded( document.querySelector('#side-bar'), function( instance ) {             var stickyTop = jQuery('.sticky_sidebar').offset().top-20-offsetAdd;             // If there's a comment section then add that to the height as well             if(jQuery('.comments').length > 0){                 console.log('there is a comment section');                 var stickyBottom = jQuery('.site-footer').innerHeight()+jQuery('.comments').innerHeight()+5;             }else{                 var stickyBottom = jQuery('.site-footer').innerHeight();             }              jQuery('.sticky_sidebar').affix({                 offset: {                     top: stickyTop,                     bottom: stickyBottom                 }             })             jQuery('.sticky_sidebar').css('width', jQuery('.sticky_sidebar').parent().width()+'px');         });     } } function openIconMenu(){     jQuery('.menu-wrapper').addClass('open-part');     fixMenuHeight()      // $('.menu-wrapper').css('top', $('#menu-main').height()+$('#menu-main').offset().top+'px');     jQuery(document).bind( eventtype , function(e){          closeMenu();          jQuery(this).unbind( eventtype );      }); } function closeIconMenu(){     jQuery('.menu-wrapper').removeClass('open-part'); } function openMenu(e){     if( isMenuOpen ) return;      fixMenuHeight()     jQuery('.menu-trigger').addClass('selected');     isMenuOpen = true;     jQuery('.menu-wrapper').addClass('open-all');     closeIconMenu(); } function closeMenu(){     if( !isMenuOpen ) return;     jQuery('.menu-trigger').removeClass('selected');     isMenuOpen = false;     jQuery('.menu-wrapper').removeClass('open-all');     closeIconMenu(); } function fixMenuHeight(){     if(!blu.disable_fixed_header || mobilecheck() ){         jQuery('.menu-wrapper').height(jQuery(window).height());     }else{         jQuery('.menu-wrapper').height(jQuery('#page').height());     } } function addDocumentClickBind(){     jQuery(document).bind( eventtype, function(e){          closeMenu();          jQuery(this).unbind( eventtype );      }); } function social_share(data) {     window.open( data, "fbshare", "height=450,width=760,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0" ); } function mobilecheck() {     var check = false;     (function(a){if(/(android|ipad|playbook|silk|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);     return check; }